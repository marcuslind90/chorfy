sudo: required
language: python
python:
  - "3.6"
services:
  - docker
  - postgresql

before_script:
  - psql -c 'create database travis_ci_test;' -U postgres
  - docker build -t chorfy/app ./app
  - docker-compose -f resources/compose/docker-compose.test.yml up -d

script:
  - docker-compose -f resources/compose/docker-compose.test.yml exec app /bin/sh -c "python -m flake8 ."
  - docker-compose -f resources/compose/docker-compose.test.yml exec app /bin/sh -c "python manage.py test --no-input"
